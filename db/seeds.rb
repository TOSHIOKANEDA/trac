ports = [
  # // 確認済み（調査で確認できたもの）
  {name: "ADEN", port_code: "YEADE"},
  {name: "HAMBURG", port_code: "DEHAM"},
  {name: "TOKYO", port_code: "JPTYO"},
  {name: "YOKOHAMA", port_code: "JPYOK"},
  {name: "SHANGHAI", port_code: "CNSHA"},
  {name: "ROTTERDAM", port_code: "NLRTM"},
  {name: "SINGAPORE", port_code: "SGSIN"},
  {name: "HONG KONG", port_code: "HKHKG"},
  {name: "ANTWERP", port_code: "BEANR"},
  {name: "SHENZHEN", port_code: "CNSZX"},
  {name: "NINGBO", port_code: "CNNGB"},
  {name: "QINGDAO", port_code: "CNTAO"},
  {name: "GUANGZHOU", port_code: "CNCAN"},
  {name: "TIANJIN", port_code: "CNTSN"},
  {name: "PUSAN", port_code: "KRPUS"},
  # // ヨーロッパ
  {name: "AARHUS", port_code: "DKAAR"},
  {name: "ABERDEEN", port_code: "GBABD"},
  {name: "AMSTERDAM", port_code: "NLAMS"},
  {name: "ANCONA", port_code: "ITAON"},
  {name: "BARCELONA", port_code: "ESBCN"},
  {name: "BARI", port_code: "ITBRI"},
  {name: "BASEL", port_code: "CHBSL"},
  {name: "BELFAST", port_code: "GBBFS"},
  {name: "BERGEN", port_code: "NOBGN"},
  {name: "BILBAO", port_code: "ESBIO"},
  {name: "BOLOGNA", port_code: "ITBLQ"},
  {name: "BREMEN", port_code: "DEBRV"},
  {name: "BREMERHAVEN", port_code: "DEBRV"},
  {name: "BRUSSELS", port_code: "BEBRU"},
  {name: "COPENHAGEN", port_code: "DKCPH"},
  {name: "CORK", port_code: "IECRK"},
  {name: "DUBLIN", port_code: "IEDUB"},
  {name: "ESBJERG", port_code: "DKESB"},
  {name: "FLORENCE", port_code: "ITFLR"},
  {name: "GDANSK", port_code: "PLGDN"},
  {name: "GDYNIA", port_code: "PLGDY"},
  {name: "GENEVA", port_code: "CHGVA"},
  {name: "GENOVA", port_code: "ITGOA"},
  {name: "GLASGOW", port_code: "GBGLW"},
  {name: "GOTHENBURG", port_code: "SEGOT"},
  {name: "GRANGEMOUTH", port_code: "GBGRG"},
  {name: "HELSINGBORG", port_code: "SEHBG"},
  {name: "HELSINKI", port_code: "FIHEL"},
  {name: "KATOWICE", port_code: "PLKTW"},
  {name: "KOTKA", port_code: "FIKTK"},
  {name: "KRAKOW", port_code: "PLKRK"},
  {name: "LA SPEZIA", port_code: "ITLSP"},
  {name: "LE HAVRE", port_code: "FRLEH"},
  {name: "LEIXOES", port_code: "PTLEX"},
  {name: "LIVORNO", port_code: "ITLIV"},
  {name: "LODZ", port_code: "PLLCJ"},
  {name: "LONDON", port_code: "GBLON"},
  {name: "LYON", port_code: "FRLYS"},
  {name: "MALAGA", port_code: "ESAGP"},
  {name: "MALMO", port_code: "SEMMA"},
  {name: "MARSEILLES", port_code: "FRMRS"},
  {name: "MESSINA", port_code: "ITMSN"},
  {name: "MILAN", port_code: "ITMIL"},
  {name: "MODENA", port_code: "ITMOD"},
  {name: "MUNICH", port_code: "DEMUC"},
  {name: "NAPLES", port_code: "ITNAP"},
  {name: "OSLO", port_code: "NOOSL"},
  {name: "PALERMO", port_code: "ITPMO"},
  {name: "PALMA DE MALLORCA", port_code: "ESPMI"},
  {name: "PARIS G", port_code: "FRPAR"},
  {name: "PASAJES", port_code: "ESPAS"},
  {name: "PIRAEUS", port_code: "GRPIR"},
  {name: "PISA", port_code: "ITPSA"},
  {name: "PLYMOUTH", port_code: "GBPLY"},
  {name: "POZNAN", port_code: "PLPOZ"},
  {name: "PRAGUE", port_code: "CZPRG"},
  {name: "RAVENNA", port_code: "ITRAV"},
  {name: "RIGA", port_code: "LVRIX"},
  {name: "RIJEKA", port_code: "HRRJK"},
  {name: "ROME", port_code: "ITROM"},
  {name: "ROSTOCK", port_code: "DERST"},
  {name: "SAINT PETERSBURG", port_code: "RULED"},
  {name: "SALERNO", port_code: "ITSAL"},
  {name: "STOCKHOLM", port_code: "SESTO"},
  {name: "STUTTGART", port_code: "DESTR"},
  {name: "TALLINN", port_code: "EETLL"},
  {name: "TARANTO", port_code: "ITTAR"},
  {name: "THESSALONIKI", port_code: "GRTHE"},
  {name: "TRIESTE", port_code: "ITTRS"},
  {name: "TURIN", port_code: "ITTRN"},
  {name: "TURKU", port_code: "FITUR"},
  {name: "VALENCIA", port_code: "ESVLC"},
  {name: "VALLETTA", port_code: "MTVLA"},
  {name: "VARNA", port_code: "BGVAR"},
  {name: "VENICE", port_code: "ITVCE"},
  {name: "VERONA", port_code: "ITVNA"},
  {name: "VIGO", port_code: "ESVGO"},
  {name: "VLORE", port_code: "ALVLR"},
  {name: "VOLOS", port_code: "GRVOL"},
  {name: "WARSAW", port_code: "PLWAW"},
  {name: "ZURICH", port_code: "CHZUR"},

  # // アジア
  {name: "BANGKOK", port_code: "THBKK"},
  {name: "CHENNAI", port_code: "INMAA"},
  {name: "CHIBA", port_code: "JPCHB"},
  {name: "CHITTAGONG", port_code: "BDCGP"},
  {name: "CHONGJIN", port_code: "KPCHJ"},
  {name: "COCHIN", port_code: "INCOK"},
  {name: "COLOMBO", port_code: "LKCMB"},
  {name: "DAILIAN", port_code: "CNDLC"},
  {name: "DONG GUAN", port_code: "CNDGG"},
  {name: "FUZHOU", port_code: "CNFOC"},
  {name: "HACHINOHE", port_code: "JPHNJ"},
  {name: "HAIKOU", port_code: "CNHAK"},
  {name: "HAKATA", port_code: "JPHKT"},
  {name: "HALDIA", port_code: "INHLD"},
  {name: "HANGZHOU", port_code: "CNHGH"},
  {name: "HIROSHIMA", port_code: "JPHIJ"},
  {name: "HITACHI", port_code: "JPHTI"},
  {name: "HUANGPU", port_code: "CNHUP"},
  {name: "IMABARI", port_code: "JPIMB"},
  {name: "INCHEON", port_code: "KRICN"},
  {name: "JAKARTA", port_code: "IDJKT"},
  {name: "JAMBI", port_code: "IDJMB"},
  {name: "JAWAHARLAL NEHRU", port_code: "INJNP"},
  {name: "JIANGMEN", port_code: "CNJGM"},
  {name: "JOHARBAHRU", port_code: "MYJHB"},
  {name: "KAGOSHIMA", port_code: "JPKOJ"},
  {name: "KANDLA", port_code: "INKDL"},
  {name: "KAOHSIUNG", port_code: "TWKHH"},
  {name: "KEELUNG", port_code: "TWKEL"},
  {name: "KOBE", port_code: "JPUKB"},
  {name: "KOLKATA", port_code: "INCCU"},
  {name: "KOTA KINABALU", port_code: "MYKKI"},
  {name: "KUALA BELAIT", port_code: "BNKBT"},
  {name: "KUANTAN", port_code: "MYKUA"},
  {name: "KUCHING", port_code: "MYKCH"},
  {name: "LAEM CHABANG", port_code: "THLCB"},
  {name: "LAHAD DATU", port_code: "MYLHD"},
  {name: "LIANYUNGANG", port_code: "CNLYG"},
  {name: "MACAU", port_code: "MOMFM"},
  {name: "MANILA", port_code: "PHMNL"},
  {name: "MEDAN", port_code: "IDMDN"},
  {name: "MIZUSHIMA", port_code: "JPMZM"},
  {name: "MOJI", port_code: "JPMJI"},
  {name: "MUMBAI", port_code: "INBOM"},
  {name: "MUNDRA", port_code: "INMDR"},
  {name: "NAGOYA", port_code: "JPNGO"},
  {name: "NAHA", port_code: "JPNHA"},
  {name: "NAKHODKA", port_code: "RUNHK"},
  {name: "NAMPO", port_code: "KPNMP"},
  {name: "NANJING", port_code: "CNNJG"},
  {name: "NEW MANGALORE", port_code: "INMNG"},
  {name: "NIIGATA", port_code: "JPKIJ"},
  {name: "OSAKA", port_code: "JPOSA"},
  {name: "PADANG", port_code: "IDPDG"},
  {name: "PALEMBANG", port_code: "IDPLM"},
  {name: "PANJANG", port_code: "IDPJG"},
  {name: "PARADEEP", port_code: "INPRD"},
  {name: "PENANG", port_code: "MYPKG"},
  {name: "PHNOM PENH", port_code: "KHPNH"},
  {name: "PIPAVAV", port_code: "INPPV"},
  {name: "PORT KELANG", port_code: "MYPKG"},
  {name: "QUANZHOU", port_code: "CNQZH"},
  {name: "SAKAI", port_code: "JPSKA"},
  {name: "SAKAIMINATO", port_code: "JPSKM"},
  {name: "SANDAKAN", port_code: "MYSDK"},
  {name: "SEMARANG", port_code: "IDSMG"},
  {name: "SENBOKU", port_code: "JPSNB"},
  {name: "SENDAI", port_code: "JPSND"},
  {name: "SHANTOU", port_code: "CNSWX"},
  {name: "SHAOXING", port_code: "CNSHX"},
  {name: "SHEKOU", port_code: "CNSHK"},
  {name: "SHIBUSHI", port_code: "JPSHB"},
  {name: "SHIMIZU", port_code: "JPSHZ"},
  {name: "SHIQI", port_code: "CNSHQ"},
  {name: "SIBU", port_code: "MYSBU"},
  {name: "SIHANOUKVILLE", port_code: "KHKOS"},
  {name: "SONGKHLA", port_code: "THSGZ"},
  {name: "SURABAYA", port_code: "IDSUB"},
  {name: "SUZHOU", port_code: "CNSZH"},
  {name: "TAICHUNG", port_code: "TWTXG"},
  {name: "TAIPEI", port_code: "TWTPE"},
  {name: "TAWAU", port_code: "MYTWU"},
  {name: "TOMAKOMAI", port_code: "JPTMK"},
  {name: "TOYAMA", port_code: "JPTOY"},
  {name: "TUTICORIN", port_code: "INTUT"},
  {name: "VISAKHAPATNAM", port_code: "INVTZ"},
  {name: "VLADIVOSTOK", port_code: "RUVVO"},
  {name: "WEIHAI", port_code: "CNWEH"},
  {name: "WENZHOU", port_code: "CNWZH"},
  {name: "WU HAN", port_code: "CNWUH"},
  {name: "WUHU", port_code: "CNWHU"},
  {name: "WUXI", port_code: "CNWXI"},
  {name: "WUZHOU", port_code: "CNWUZ"},
  {name: "XIAMEN", port_code: "CNXMN"},
  {name: "YANGON", port_code: "MMRGN"},
  {name: "YANGZHOU", port_code: "CNYZH"},
  {name: "YANTAI", port_code: "CNYNT"},
  {name: "YOKKAICHI", port_code: "JPYKK"},
  {name: "ZHANGJIAGANG", port_code: "CNZJG"},
  {name: "ZHANJIANG", port_code: "CNZHA"},
  {name: "ZHAOQING", port_code: "CNZHQ"},
  {name: "ZHUHAI", port_code: "CNZUH"},

  # // 中東・アフリカ
  {name: "ABIDJAN", port_code: "CIABJ"},
  {name: "ADABIYA", port_code: "EGADA"},
  {name: "AGADIR", port_code: "MAAGA"},
  {name: "AL JUBAIL", port_code: "SAJUB"},
  {name: "ALEXANDRIA", port_code: "EGALY"},
  {name: "ALGIERS", port_code: "DZALG"},
  {name: "ANNABA", port_code: "DZAAE"},
  {name: "APAPA", port_code: "NGAPA"},
  {name: "AQABA", port_code: "JOAQJ"},
  {name: "ASHDOD", port_code: "ILASD"},
  {name: "ASSAB", port_code: "ERASSB"},
  {name: "BANDAR ABBAS", port_code: "IRBND"},
  {name: "BANDAR KHOMEINI", port_code: "IRBKH"},
  {name: "BANJUL", port_code: "GMBJL"},
  {name: "BEIRA", port_code: "MZBEI"},
  {name: "BEIRUT", port_code: "LBBEY"},
  {name: "BENGHAZI", port_code: "LYBNJ"},
  {name: "BERBERA", port_code: "SOBER"},
  {name: "BIZERTE", port_code: "TNBIZ"},
  {name: "CAPE TOWN", port_code: "ZACPT"},
  {name: "CASABLANCA", port_code: "MACAS"},
  {name: "COTONOU", port_code: "BJCOO"},
  {name: "DAKAR", port_code: "SNDKR"},
  {name: "DAMIETTA", port_code: "EGDAM"},
  {name: "DAMMAM", port_code: "SADAM"},
  {name: "DAR ES SALAAM", port_code: "TZDAR"},
  {name: "DIEGO SUAREZ", port_code: "MGANT"},
  {name: "DJIBOUTI", port_code: "DJJIB"},
  {name: "DOHA", port_code: "QADOH"},
  {name: "DOUALA", port_code: "CMDLA"},
  {name: "DURBAN", port_code: "ZADUR"},
  {name: "EAST LONDON", port_code: "ZAELS"},
  {name: "FREETOWN", port_code: "SLFNA"},
  {name: "GABES", port_code: "TNGAB"},
  {name: "HAIFA", port_code: "ILHFA"},
  {name: "HODEIDAH", port_code: "YEHOD"},
  {name: "ISKENDERUN", port_code: "TRISK"},
  {name: "ISTANBUL", port_code: "TRIST"},
  {name: "IZMIR", port_code: "TRADB"},
  {name: "JEDDAH", port_code: "SAJED"},
  {name: "KISH ISLAND", port_code: "IRKSH"},
  {name: "KISMAYA", port_code: "SOKIS"},
  {name: "LAGOS", port_code: "NGLOS"},
  {name: "LARNACA", port_code: "CYLCA"},
  {name: "LAS PALMAS", port_code: "ESLPA"},
  {name: "LATTAKIA", port_code: "SYLAT"},
  {name: "LIBREVILLE", port_code: "GALIB"},
  {name: "LIMASSOL", port_code: "CYLMS"},
  {name: "LOBITO", port_code: "AOLOB"},
  {name: "LOME", port_code: "TGLFW"},
  {name: "LUANDA", port_code: "AOLAD"},
  {name: "LUDERITZ", port_code: "NALUD"},
  {name: "MAHE", port_code: "SCMAH"},
  {name: "MAJUNGA", port_code: "MGMJN"},
  {name: "MANAMA", port_code: "BHBAH"},
  {name: "MAPUTO", port_code: "MZMPM"},
  {name: "MASSAWA", port_code: "ERMSA"},
  {name: "MERSIN", port_code: "TRICE"},
  {name: "MISRATAH", port_code: "LYMRA"},
  {name: "MOGADISHU", port_code: "SOMGQ"},
  {name: "MOMBASA", port_code: "KEMBA"},
  {name: "MORONI", port_code: "KMYVA"},
  {name: "MUSCAT", port_code: "OMMCT"},
  {name: "MUTSAMUDU", port_code: "KMMUT"},
  {name: "NACALA", port_code: "MZNCA"},
  {name: "NOUADHIBOU", port_code: "MRNDB"},
  {name: "NOUAKCHOTT", port_code: "MRNKC"},
  {name: "ORAN", port_code: "DZORN"},
  {name: "PORT ELIZABETH", port_code: "ZAPLZ"},
  {name: "PORT GENTIL", port_code: "GAPOG"},
  {name: "PORT HARCOURT", port_code: "NGPHC"},
  {name: "PORT LOUIS", port_code: "MUPLU"},
  {name: "PORT SUDAN", port_code: "SDPZU"},
  {name: "PORT SUEZ", port_code: "EGSUZ"},
  {name: "RADES", port_code: "TNRAD"},
  {name: "RICHARDS BAY", port_code: "ZARCB"},
  {name: "SALALAH", port_code: "OMSLL"},
  {name: "SFAX", port_code: "TNSFX"},
  {name: "SKIKDA", port_code: "DZSKI"},
  {name: "TAKORADI", port_code: "GHTKD"},
  {name: "TAMATAVE", port_code: "MGTMT"},
  {name: "TANGA", port_code: "TZTGA"},
  {name: "TEMA", port_code: "GHTEM"},
  {name: "TINCAN ISLAND", port_code: "NGTIN"},
  {name: "TRABZON", port_code: "TRTBZ"},
  {name: "TRIPOLI", port_code: "LYTIP"},
  {name: "UMM QASR", port_code: "IQUMQ"},
  {name: "UMM SAID", port_code: "QAUMD"},
  {name: "WALVIS BAY", port_code: "NAWVB"},
  {name: "ZANZIBAR", port_code: "TZZNZ"},

  # // 南北アメリカ
  {name: "ACAPULCO", port_code: "MXACA"},
  {name: "ALTAMIRA", port_code: "MXATM"},
  {name: "BAHIA", port_code: "BRSSA"},
  {name: "BALBOA", port_code: "PABAL"},
  {name: "BARRANQUILLA", port_code: "COBAQ"},
  {name: "BELEM", port_code: "BRBEL"},
  {name: "BELIZE", port_code: "BZBZE"},
  {name: "BRIDGETOWN", port_code: "BBBGI"},
  {name: "BUENAVENTURA", port_code: "COBUN"},
  {name: "BUENOS AIRES", port_code: "ARBUE"},
  {name: "CALLAO", port_code: "PECLL"},
  {name: "CARTAGENA", port_code: "COCTG"},
  {name: "COLON", port_code: "PACLN"},
  {name: "CORINTO", port_code: "NICIN"},
  {name: "CRISTOBAL", port_code: "PACRB"},
  {name: "CURACAO", port_code: "CWCUR"},
  {name: "ENSENADA", port_code: "MXENS"},
  {name: "FORTALEZA", port_code: "BRFOR"},
  {name: "GUAYAQUIL", port_code: "ECGYE"},
  {name: "HALIFAX", port_code: "CAHAL"},
  {name: "HAVANA", port_code: "CUHAV"},
  {name: "KINGSTON", port_code: "JMKIN"},
  {name: "KINGSTOWN", port_code: "VCSVU"},
  {name: "LAZARO CARDENAS", port_code: "MXLZC"},
  {name: "MANTA", port_code: "ECMNT"},
  {name: "MANZANILLO", port_code: "MXMAN"},
  {name: "MATANZAS", port_code: "CUMTQ"},
  {name: "MEXICO CITY", port_code: "MXMEX"},
  {name: "MONTREAL", port_code: "CAMTR"},
  {name: "NASSAU", port_code: "BSNAS"},
  {name: "PANAMA CITY", port_code: "PAPAC"},
  {name: "PARANAGUA", port_code: "BRPNG"},
  {name: "PORT-AU-PRINCE", port_code: "HTPAP"},
  {name: "PORTOALEGRE", port_code: "BRPOA"},
  {name: "PRINCE RUPERT", port_code: "CAPRZ"},
  {name: "PUERTO CALDERA", port_code: "CRPCR"},
  {name: "PUERTO CORTES", port_code: "HNPCO"},
  {name: "PUERTO LIMON", port_code: "CRPLM"},
  {name: "PUERTO QUETZAL", port_code: "GTPQU"},
  {name: "PUNTA ARENAS", port_code: "CLPUN"},
  {name: "PUNTARENAS", port_code: "CRPNT"},
  {name: "RECIFE", port_code: "BRREC"},
  {name: "RIO DE JANEIRO", port_code: "BRRIO"},
  {name: "RIO GRANDE", port_code: "BRRIG"},
  {name: "ROSARIO", port_code: "ARROS"},
  {name: "ROSEAU", port_code: "DMROO"},
  {name: "SALVADOR", port_code: "BRSAL"},
  {name: "SAN ANTONIO", port_code: "CLSAI"},
  {name: "SAN JUAN", port_code: "PRSJU"},
  {name: "SANTA MARTA", port_code: "COSMR"},
  {name: "SANTIAGO", port_code: "CLSCL"},
  {name: "SANTO DOMINGO", port_code: "DOSDQ"},
  {name: "SANTOS", port_code: "BRSSZ"},
  {name: "SAO FRANCISCO DO SUL", port_code: "BRSFS"},
  {name: "TAMPICO", port_code: "MXTAM"},
  {name: "TORONTO", port_code: "CATOR"},
  {name: "USHUAIA", port_code: "ARUSH"},
  {name: "VALDEZ", port_code: "USVDZ"},
  {name: "VALPARAISO", port_code: "CLVAP"},
  {name: "VANCOUVER", port_code: "CAVAN"},
  {name: "VERA CRUZ", port_code: "MXVER"},
  {name: "VITORIA", port_code: "BRVIX"},

  # // オセアニア・太平洋
  {name: "ALOTAU", port_code: "PGALP"},
  {name: "AUCKLAND", port_code: "NZAKL"},
  {name: "BLUFF", port_code: "NZBLF"},
  {name: "CHRISTCHURCH", port_code: "NZCHC"},
  {name: "DUNEDIN", port_code: "NZDUD"},
  {name: "EBEYE", port_code: "MHEBY"},
  {name: "FUNAFUTI", port_code: "TVFUN"},
  {name: "HONIARA", port_code: "SBHIR"},
  {name: "HONOLULU", port_code: "USHNL"},
  {name: "INVERCARGILL", port_code: "NZIVC"},
  {name: "KAVIENG", port_code: "PGKVG"},
  {name: "KIMBE", port_code: "PGKMB"},
  {name: "KOROR", port_code: "PWROR"},
  {name: "LAE", port_code: "PGLAE"},
  {name: "LAUTTOKA", port_code: "FJLTK"},
  {name: "LYTTELTON", port_code: "NZLYT"},
  {name: "MADANG", port_code: "PGMAG"},
  {name: "MAJURO", port_code: "MHMAJ"},
  {name: "NAPIER", port_code: "NZNPE"},
  {name: "NELSON", port_code: "NZNSN"},
  {name: "NEW PLYMOUTH", port_code: "NZNPL"},
  {name: "NORO", port_code: "SBNRO"},
  {name: "NOUMEA", port_code: "NCNOU"},
  {name: "NUKUALOFA", port_code: "TONKU"},
  {name: "ORO BAY", port_code: "PGORB"},
  {name: "PAGO PAGO", port_code: "ASPPG"},
  {name: "PAPEETE", port_code: "PFPPT"},
  {name: "POHNPEI", port_code: "FMPNI"},
  {name: "PORT MORESBY", port_code: "PGPOM"},
  {name: "SAIPAN", port_code: "MPSPN"},
  {name: "SUVA", port_code: "FJSUV"},
  {name: "TAURANGA", port_code: "NZTBH"},
  {name: "TIMARU", port_code: "NZTIU"},
  {name: "VAVAU", port_code: "TOVAV"},
  {name: "WELLINGTON", port_code: "NZWLG"},
  {name: "WEWAK", port_code: "PGWWK"},

  # // その他（確認できなかった港は推定）
  {name: "APRILIA", port_code: "ITAPR"},
  {name: "BASSE-TERRE", port_code: "GPBAS"},
  {name: "BATU AMPAR", port_code: "IDBTM"},
  {name: "BEHIA", port_code: "BRBEH"},
  {name: "BELAWAN", port_code: "IDBLW"},
  {name: "BELHAI", port_code: "CNBLH"},
  {name: "BENGKULU", port_code: "IDBKL"},
  {name: "BERJAIA", port_code: "DZBJY"},
  {name: "BLANKA", port_code: "HRBLK"},
  {name: "BULAWAYO", port_code: "ZWBUW"},
  {name: "BURGAS", port_code: "BGBOJ"},
  {name: "BYDGOSZCZ", port_code: "PLBZG"},
  {name: "BYTOM", port_code: "PLBOM"},
  {name: "CALBAYOG", port_code: "PHCYP"},
  {name: "CAMBRIDGE", port_code: "GBCMG"},
  {name: "CARDOVA", port_code: "PHCRD"},
  {name: "CASSIBILE", port_code: "ITCAS"},
  {name: "CATANIA", port_code: "ITCTA"},
  {name: "CEBU", port_code: "PHCEB"},
  {name: "CEUTA", port_code: "EACEU"},
  {name: "CHANARAL", port_code: "CLCNR"},
  {name: "CIREBON", port_code: "IDCRB"},
  {name: "CONSTANZA", port_code: "ROCND"},
  {name: "CORDOBA", port_code: "ARCOR"},
  {name: "DAVAO", port_code: "PHDVO"},
  {name: "DEGIO SUAREZ", port_code: "MGDGS"},
  {name: "DERINCE", port_code: "TRDER"},
  {name: "DILI", port_code: "TLDLI"},
  {name: "DUMAN", port_code: "CNDMN"},
  {name: "DUO", port_code: "CNDUO"},
  {name: "DURRES", port_code: "ALDUR"},
  {name: "ENNORE", port_code: "INENO"},
  {name: "ESMERALDAS", port_code: "ECESM"},
  {name: "FAMAGUSTA", port_code: "CYFMG"},
  {name: "FANCHENG", port_code: "CNFCG"},
  {name: "FLUSHING", port_code: "NLVLI"},
  {name: "FOS", port_code: "FRFOS"},
  {name: "FOSHAN", port_code: "CNFOS"},
  {name: "GATUN", port_code: "PAGTL"},
  {name: "GENERAL SANTOS", port_code: "PHGSC"},
  {name: "GRANADA", port_code: "ESGRD"},
  {name: "GUADALAJARA", port_code: "MXGDL"},
  {name: "HARARE", port_code: "ZWHRE"},
  {name: "HSINGKANG", port_code: "CNHSK"},
  {name: "IQUIQUE", port_code: "CLIQQ"},
  {name: "ITAJAI", port_code: "BRITJ"},
  {name: "IWAKI", port_code: "JPIWK"},
  {name: "JOHANNESBURG", port_code: "ZAJNB"},
  {name: "KABIL", port_code: "AFKBL"},
  {name: "KAMPONGSOM", port_code: "KHKOS"},
  {name: "KAVALLA", port_code: "GRKAV"},
  {name: "KUPANG", port_code: "IDKPG"},
  {name: "KUWAIT L", port_code: "KWKWI"},
  {name: "LABUAN", port_code: "MYLBN"},
  {name: "LACENA", port_code: "ITLAC"},
  {name: "LATINA", port_code: "ITLAT"},
  {name: "LIRQUEN", port_code: "CLLQN"},
  {name: "LLOILO", port_code: "PHILO"},
  {name: "LUDA", port_code: "CNLUD"},
  {name: "LUDWIGSBURG", port_code: "DELUD"},
  {name: "MACAPA", port_code: "BRMCP"},
  {name: "MACOU", port_code: "CNMCO"},
  {name: "MADRID", port_code: "ESMAD"},
  {name: "MALE", port_code: "MVMLE"},
  {name: "MANAUS", port_code: "BRMAO"},
  {name: "MAYOTTE", port_code: "YTMAM"},
  {name: "MELILLA", port_code: "EAMLI"},
  {name: "MENDOZA", port_code: "ARMZA"},
  {name: "MIRI", port_code: "MYMRI"},
  {name: "MONFALCONE", port_code: "ITMFN"},
  {name: "MONGLA", port_code: "BDMGL"},
  {name: "MONROVIA", port_code: "LRMLW"},
  {name: "MORMUGAO", port_code: "INMRM"},
  {name: "MOSCOW", port_code: "RUMOW"},
  {name: "MUARA", port_code: "BNMUA"},
  {name: "MUKA KUNING", port_code: "IDMUK"},
  {name: "MUKALLA", port_code: "YEMKL"},
  {name: "NANTES", port_code: "FRNCE"},
  {name: "NANTUNG", port_code: "CNNTG"},
  {name: "NORO", port_code: "SBNRO"},
  {name: "NOSE BE", port_code: "MGNSB"},
  {name: "NOSY BE", port_code: "MGNSB"},
  {name: "OKINAWA", port_code: "JPOKI"},
  {name: "ORANJESTAD", port_code: "AWORA"},
  {name: "PASIR GUDANG", port_code: "MYPGU"},
  {name: "PATRAI", port_code: "GRPAT"},
  {name: "PEKAN BARU", port_code: "IDPKB"},
  {name: "PERAWANG", port_code: "IDPRW"},
  {name: "PHILIPSBURG", port_code: "SXPHI"},
  {name: "PLAJU", port_code: "IDPLJ"},
  {name: "POINT LISAS", port_code: "TTPTL"},
  {name: "POINTE DES GALETS", port_code: "REPDG"},
  {name: "POINTE NOIRE", port_code: "CGPNR"},
  {name: "PONAPE", port_code: "FMPNI"},
  {name: "PONCE", port_code: "PRPSE"},
  {name: "PONTIANAK", port_code: "IDPNK"},
  {name: "PORT BLAIR", port_code: "INPBR"},
  {name: "PORT CHALMERS", port_code: "NZPOC"},
  {name: "PORT DE-FRANCE", port_code: "MQFDF"},
  {name: "PORT NOVO", port_code: "BJPNO"},
  {name: "PORT OF SPAIN", port_code: "TTPOS"},
  {name: "PORT PEGASUS", port_code: "NZPPG"},
  {name: "PORT SAIDEL SALVADOR", port_code: "EGPSD"},
  {name: "PORT/NSICT", port_code: "INNSI"},
  {name: "PRETORIA", port_code: "ZAPRQ"},
  {name: "QUINGHUANG", port_code: "CNQHD"},
  {name: "RABAUL", port_code: "PGRBL"},
  {name: "REGGIO", port_code: "ITREG"},
  {name: "RIO GRANDE DO SUL", port_code: "BRRIG"},
  {name: "RIO HAINA", port_code: "DORIH"},
  {name: "RIYADH", port_code: "SARUH"},
  {name: "ROSTOV", port_code: "RUROV"},
  {name: "SALINA CRUZ", port_code: "MXSCZ"},
  {name: "SALONICA", port_code: "GRTHE"},
  {name: "SAMARINDA", port_code: "IDSMR"},
  {name: "SAMPIT", port_code: "IDSMP"},
  {name: "SAN JOSE", port_code: "CRSJO"},
  {name: "SAN LORENZO", port_code: "ARSLR"},
  {name: "SAN PEDRO", port_code: "CIVSPD"},
  {name: "SAN PEDRO SULA", port_code: "HNSAP"},
  {name: "SANTA CRUZ DE TENERIFE", port_code: "ESSCT"},
  {name: "SANTO", port_code: "VUSAN"},
  {name: "SANTO TOMAS DE CASTILLA", port_code: "GTSTC"},
  {name: "SEKONDI", port_code: "GHSEK"},
  {name: "SEKUPANG", port_code: "IDSKP"},
  {name: "SHIKOU", port_code: "CNSHK"},
  {name: "SITTIVE", port_code: "MMSIT"},
  {name: "SOFIA", port_code: "BGSOF"},
  {name: "SONDERBURG", port_code: "DKSON"},
  {name: "ST. GEORGE'S", port_code: "GDGND"},
  {name: "ST. JOHNS", port_code: "AGANU"},
  {name: "ST. LOUIS", port_code: "SNDKR"},
  {name: "STAVANGER", port_code: "NOSVG"},
  {name: "SUAPE", port_code: "BRSUA"},
  {name: "TANJONG MANI", port_code: "MYTNM"},
  {name: "TANJUNG UNCANG", port_code: "IDTJU"},
  {name: "TENERIFE", port_code: "ESSCT"},
  {name: "TOAMASINE", port_code: "MGTOM"},
  {name: "TOLEDO", port_code: "ESTOL"},
  {name: "TOLIARY", port_code: "MGTLY"},
  {name: "TRUK", port_code: "FMTRK"},
  {name: "UJUNG PANDANG", port_code: "IDUPG"},
  {name: "VILA", port_code: "VUVLI"},
  {name: "WEXFORD", port_code: "IEWEX"},
  {name: "WILLEMSTAD", port_code: "CWCUR"},
  {name: "ZAMBOANGA", port_code: "PHZMB"},
  {name: "ZARAGOZA", port_code: "ESZAR"}
];
PortList.insert_all(ports)

# db/seeds.rb

# 既存データをクリア（開発環境のみ）
if Rails.env.development?
  puts "⚠️  Cleaning existing data..."
  [
    Message,
    ChatUser,
    Chat,
    FinbalanceAssembly,
    Finbalance,
    Container,
    EventDoc,
    EventGood,
    EventStep,
    EventSchedule,
    EventShipment,
    EventCompany,
    Event,
    QuotationItem,
    QuotationCompany,
    Quotation,
    FavoriteFinbalanceAssembly,
    FavoriteFinbalance,
    FavoriteDoc,
    FavoriteGood,
    FavoriteShipment,
    FavoriteCompany,
    Favorite,
    FinbalanceItem,
    User,
    CompanyBusinessCategory,
    Company,
    BusinessCategory,
  ].each(&:destroy_all)
end

puts "🌱 Starting seed..."

# ==============================================
# 1. Business Categories
# ==============================================
puts "\n📦 Creating Business Categories..."

# 0から6までのカテゴリを作成（enumで定義されている想定）
0.upto(6) do |num|
  BusinessCategory.create!(category: num)
  puts "  ✓ Created: category #{num}"
end

# ==============================================
# 2. Companies
# ==============================================
puts "\n🏢 Creating Companies..."

# フォワーダー（物流会社）
forwarder = Company.create!(
  japanese_name: "東京国際物流株式会社",
  english_name: "Tokyo International Logistics Co., Ltd.",
  address: "東京都港区芝浦1-2-3",
  is_forwarder: true,
  status: true,
  deal_memo: "主要取引先",
  company_memo: "海上輸送に強み"
)
puts "  ✓ Created Forwarder: #{forwarder.japanese_name}"

forwarder2 = Company.create!(
  japanese_name: "大阪フォワーディング株式会社",
  english_name: "Osaka Forwarding Co., Ltd.",
  address: "大阪府大阪市北区梅田2-4-9",
  is_forwarder: true,
  status: true,
  deal_memo: "関西エリア担当",
  company_memo: "航空便に強み"
)
puts "  ✓ Created Forwarder: #{forwarder2.japanese_name}"

# Agent（代理店）
agents = [
  { jp: "関西総合エージェンシー株式会社", en: "Kansai General Agency Co., Ltd.", addr: "大阪府大阪市中央区", memo: "関西エリア代理店" },
  { jp: "九州国際サービス株式会社", en: "Kyushu International Service Co., Ltd.", addr: "福岡県福岡市博多区", memo: "九州エリア代理店" },
  { jp: "北海道ロジスティクス株式会社", en: "Hokkaido Logistics Co., Ltd.", addr: "北海道札幌市中央区", memo: "北海道エリア代理店" },
  { jp: "中部通商代理店株式会社", en: "Chubu Trading Agency Co., Ltd.", addr: "愛知県名古屋市中区", memo: "中部エリア代理店" },
  { jp: "東北マリンサービス株式会社", en: "Tohoku Marine Service Co., Ltd.", addr: "宮城県仙台市青葉区", memo: "東北エリア代理店" }
]

agent_companies = agents.map do |company_data|
  Company.create!(
    japanese_name: company_data[:jp],
    english_name: company_data[:en],
    address: company_data[:addr],
    is_forwarder: false,
    status: true,
    company_memo: company_data[:memo]
  ).tap { |c| puts "  ✓ Created Agent: #{c.japanese_name}" }
end

# Shipper（荷主）
shippers = [
  { jp: "グローバル商事株式会社", en: "Global Trading Co., Ltd.", addr: "東京都千代田区丸の内1-1-1", memo: "電子機器輸出" },
  { jp: "日本精密機器株式会社", en: "Japan Precision Equipment Co., Ltd.", addr: "静岡県浜松市中区", memo: "精密機器製造" },
  { jp: "関東電子部品株式会社", en: "Kanto Electronic Components Co., Ltd.", addr: "埼玉県さいたま市大宮区", memo: "電子部品製造" },
  { jp: "大和製作所株式会社", en: "Yamato Manufacturing Co., Ltd.", addr: "兵庫県神戸市中央区", memo: "機械部品製造" },
  { jp: "富士商事株式会社", en: "Fuji Trading Co., Ltd.", addr: "東京都新宿区西新宿2-8-1", memo: "総合商社" }
]

shipper_companies = shippers.map do |company_data|
  Company.create!(
    japanese_name: company_data[:jp],
    english_name: company_data[:en],
    address: company_data[:addr],
    is_forwarder: false,
    status: true,
    deal_memo: company_data[:memo]
  ).tap { |c| puts "  ✓ Created Shipper: #{c.japanese_name}" }
end

# Consignee（荷受人）
consignees = [
  { jp: "太平洋トレーディング株式会社", en: "Pacific Trading Co., Ltd.", addr: "東京都品川区大崎1-5-1", memo: "輸入商社" },
  { jp: "日本輸入商事株式会社", en: "Japan Import Trading Co., Ltd.", addr: "大阪府堺市堺区", memo: "輸入専門" },
  { jp: "アジア流通株式会社", en: "Asia Distribution Co., Ltd.", addr: "神奈川県川崎市川崎区", memo: "流通業" },
  { jp: "グローバル商材株式会社", en: "Global Materials Co., Ltd.", addr: "千葉県千葉市美浜区", memo: "原材料輸入" },
  { jp: "東日本インターナショナル株式会社", en: "East Japan International Co., Ltd.", addr: "茨城県つくば市", memo: "国際貿易" }
]

consignee_companies = consignees.map do |company_data|
  Company.create!(
    japanese_name: company_data[:jp],
    english_name: company_data[:en],
    address: company_data[:addr],
    is_forwarder: false,
    status: true,
    company_memo: company_data[:memo]
  ).tap { |c| puts "  ✓ Created Consignee: #{c.japanese_name}" }
end

# Custom（通関業者）
customs = [
  { jp: "東京通関サービス株式会社", en: "Tokyo Customs Service Co., Ltd.", addr: "東京都江東区青海2-4-32", memo: "東京港専門" },
  { jp: "横浜港通関株式会社", en: "Yokohama Port Customs Co., Ltd.", addr: "神奈川県横浜市中区海岸通1-1", memo: "横浜港専門" },
  { jp: "関西通関ブローカー株式会社", en: "Kansai Customs Broker Co., Ltd.", addr: "大阪府大阪市港区", memo: "大阪港専門" },
  { jp: "神戸関税代理株式会社", en: "Kobe Customs Agency Co., Ltd.", addr: "兵庫県神戸市中央区", memo: "神戸港専門" },
  { jp: "中部通関業務株式会社", en: "Chubu Customs Operations Co., Ltd.", addr: "愛知県名古屋市港区", memo: "名古屋港専門" }
]

custom_companies = customs.map do |company_data|
  Company.create!(
    japanese_name: company_data[:jp],
    english_name: company_data[:en],
    address: company_data[:addr],
    is_forwarder: false,
    status: true,
    deal_memo: "通関業務",
    company_memo: company_data[:memo]
  ).tap { |c| puts "  ✓ Created Customs: #{c.japanese_name}" }
end

# 運送会社
trucking_companies = [
  { jp: "東京運輸株式会社", en: "Tokyo Transport Co., Ltd.", addr: "東京都大田区平和島3-1-1", memo: "都内近郊配送" },
  { jp: "関東トラック株式会社", en: "Kanto Truck Co., Ltd.", addr: "埼玉県戸田市", memo: "関東エリア配送" }
]

trucking_companies.each do |company_data|
  Company.create!(
    japanese_name: company_data[:jp],
    english_name: company_data[:en],
    address: company_data[:addr],
    is_forwarder: false,
    status: true,
    deal_memo: "国内配送",
    company_memo: company_data[:memo]
  ).tap { |c| puts "  ✓ Created Trucking: #{c.japanese_name}" }
end

# 複数役割兼務の会社
multi_role1 = Company.create!(
  japanese_name: "総合物流ソリューションズ株式会社",
  english_name: "Integrated Logistics Solutions Co., Ltd.",
  address: "東京都中央区日本橋1-1-1",
  is_forwarder: false,
  status: true,
  company_memo: "代理店と荷受人を兼務"
)
puts "  ✓ Created Multi-role: #{multi_role1.japanese_name}"

multi_role2 = Company.create!(
  japanese_name: "国際貿易コンサルティング株式会社",
  english_name: "International Trade Consulting Co., Ltd.",
  address: "大阪府大阪市北区堂島1-1-1",
  is_forwarder: false,
  status: true,
  company_memo: "荷主と通関業者を兼務"
)
puts "  ✓ Created Multi-role: #{multi_role2.japanese_name}"

# ==============================================
# 3. Company Business Categories（役割の紐付け）
# ==============================================
puts "\n🔗 Creating Company Business Categories..."

# 各会社に役割を紐付け（enumのシンボル名を使用）
# Agent
agent_companies.each do |company|
  if BusinessCategory.respond_to?(:find_by) && BusinessCategory.column_names.include?('category')
    bc = BusinessCategory.find_by(category: 'agent') || BusinessCategory.find_by(category: 0)
    if bc
      CompanyBusinessCategory.create!(
        forwarder_id: forwarder.id,
        company_id: company.id,
        business_category_id: bc.id
      )
    end
  end
end
puts "  ✓ Created Agent categories"

# Shipper
shipper_companies.each do |company|
  bc = BusinessCategory.find_by(category: 'shipper') || BusinessCategory.find_by(category: 1)
  if bc
    CompanyBusinessCategory.create!(
      forwarder_id: forwarder.id,
      company_id: company.id,
      business_category_id: bc.id
    )
  end
end
puts "  ✓ Created Shipper categories"

# Consignee
consignee_companies.each do |company|
  bc = BusinessCategory.find_by(category: 'consignee') || BusinessCategory.find_by(category: 2)
  if bc
    CompanyBusinessCategory.create!(
      forwarder_id: forwarder.id,
      company_id: company.id,
      business_category_id: bc.id
    )
  end
end
puts "  ✓ Created Consignee categories"

# Custom
custom_companies.each do |company|
  bc = BusinessCategory.find_by(category: 'custom') || BusinessCategory.find_by(category: 3)
  if bc
    CompanyBusinessCategory.create!(
      forwarder_id: forwarder.id,
      company_id: company.id,
      business_category_id: bc.id
    )
  end
end
puts "  ✓ Created Custom categories"

# 複数役割の紐付け
agent_bc = BusinessCategory.find_by(category: 'agent') || BusinessCategory.find_by(category: 0)
consignee_bc = BusinessCategory.find_by(category: 'consignee') || BusinessCategory.find_by(category: 2)
shipper_bc = BusinessCategory.find_by(category: 'shipper') || BusinessCategory.find_by(category: 1)
custom_bc = BusinessCategory.find_by(category: 'custom') || BusinessCategory.find_by(category: 3)

if agent_bc && consignee_bc
  CompanyBusinessCategory.create!(forwarder_id: forwarder.id, company_id: multi_role1.id, business_category_id: agent_bc.id)
  CompanyBusinessCategory.create!(forwarder_id: forwarder.id, company_id: multi_role1.id, business_category_id: consignee_bc.id)
end

if shipper_bc && custom_bc
  CompanyBusinessCategory.create!(forwarder_id: forwarder.id, company_id: multi_role2.id, business_category_id: shipper_bc.id)
  CompanyBusinessCategory.create!(forwarder_id: forwarder.id, company_id: multi_role2.id, business_category_id: custom_bc.id)
end
puts "  ✓ Created Multi-role categories"

# ==============================================
# 4. Users
# ==============================================
puts "\n👤 Creating Users..."

users = []

# Forwarder Users
users << User.create!(
  email: "admin@tokyo-logistics.example.com",
  name: "山田太郎",
  password: "password123",
  password_confirmation: "password123",
  company_id: forwarder.id,
  role: 0,
  dept: "営業部",
  phone: "03-1234-5678",
  status: true,
  confirmed_at: Time.current
)

users << User.create!(
  email: "operator@tokyo-logistics.example.com",
  name: "佐藤花子",
  password: "password123",
  password_confirmation: "password123",
  company_id: forwarder.id,
  role: 1,
  dept: "オペレーション部",
  phone: "03-1234-5679",
  status: true,
  confirmed_at: Time.current
)

users << User.create!(
  email: "sales@tokyo-logistics.example.com",
  name: "鈴木一郎",
  password: "password123",
  password_confirmation: "password123",
  company_id: forwarder.id,
  role: 2,
  dept: "営業部",
  phone: "03-1234-5680",
  status: true,
  confirmed_at: Time.current
)

puts "  ✓ Created Forwarder users (3)"

# 他の会社のユーザー（簡略版）
japanese_names = [
  ["田中次郎", "高橋美咲", "渡辺健太", "中村みさき", "小林達也"],
  ["伊藤雅子", "加藤真一", "吉田由紀", "木村裕介", "林さくら"],
  ["森和也", "清水美香", "池田聡", "石川恵子", "前田健二"],
  ["藤田智子", "岡田浩司", "長谷川理恵", "村上直樹", "近藤麻衣"]
]

[agent_companies, shipper_companies, consignee_companies, custom_companies].each_with_index do |company_list, i|
  email_prefix = %w[agent shipper consignee custom][i]
  
  company_list.first(3).each_with_index do |c, si|
    users << User.create!(
      email: "manager#{si+1}@#{email_prefix}#{si+1}.example.com",
      password: "password123",
      password_confirmation: "password123",
      company_id: c.id,
      role: 1,
      name: japanese_names[i][si],
      status: true,
      confirmed_at: Time.current
    )
  end
end

puts "  ✓ Created other company users (#{users.size - 3})"
puts "  Total users: #{User.count}"

admin_user = users.first

# ==============================================
# 5. Finbalance Items（財務項目マスター）
# ==============================================
puts "\n💰 Creating Finbalance Items..."

finbalance_items_data = [
  "集荷費用",
  "保管料",
  "梱包費",
  "輸出通関手数料",
  "輸出税・関税",
  "検査費用",
  "海上運賃",
  "航空運賃",
  "B/L発行手数料",
  "CAF",
  "BAF",
  "DO費用",
  "海上保険料",
  "コンテナチャージ",
  "THC",
  "VGM申告費用",
  "輸入通関費用",
  "輸入関税",
  "現地配送費"
]

finbalance_items_data.each do |item_name|
  FinbalanceItem.create!(
    forwarder_id: forwarder.id,
    item_name: item_name,
    create_id: admin_user.id,
    update_id: admin_user.id
  )
end

puts "  ✓ Created #{FinbalanceItem.count} Finbalance Items"

# ==============================================
# 7. Favorites（お気に入りテンプレート）
# ==============================================
puts "\n⭐ Creating Favorites..."

favorite1 = Favorite.create!(
  forwarder_id: forwarder.id,
  name: "中国輸入（上海→横浜）定番ルート",
  description: "電子機器の定期輸入案件",
  remark: "グローバル商事様向け標準パターン",
  create_id: admin_user.id,
  update_id: admin_user.id
)

favorite2 = Favorite.create!(
  forwarder_id: forwarder.id,
  name: "米国輸出（横浜→LA）標準ルート",
  description: "自動車部品の輸出案件",
  remark: "日本精密機器様向け標準パターン",
  create_id: admin_user.id,
  update_id: admin_user.id
)

favorite3 = Favorite.create!(
  forwarder_id: forwarder.id,
  name: "東南アジア輸入（バンコク→東京）",
  description: "食品輸入案件",
  remark: "太平洋トレーディング様向け",
  create_id: admin_user.id,
  update_id: admin_user.id
)

puts "  ✓ Created #{Favorite.count} Favorites"

# Favorite Companies
FavoriteCompany.create!(
  favorite_id: favorite1.id,
  company_id: shipper_companies.first.id,
  role: 0,
  create_id: admin_user.id,
  update_id: admin_user.id
)

FavoriteCompany.create!(
  favorite_id: favorite1.id,
  company_id: custom_companies.first.id,
  role: 2,
  create_id: admin_user.id,
  update_id: admin_user.id
)

puts "  ✓ Created Favorite Companies"

# Favorite Shipments
FavoriteShipment.create!(
  favorite_id: favorite1.id,
  shipment: 0,
  mode: 0,
  term: 1,
  place_of_receipt: "Shanghai Factory",
  port_of_loading: "Shanghai",
  port_of_discharge: "Yokohama",
  port_of_delivery: "横浜CY",
  carrier: "ONE",
  create_id: admin_user.id,
  update_id: admin_user.id
)

FavoriteShipment.create!(
  favorite_id: favorite2.id,
  shipment: 1,
  mode: 0,
  term: 0,
  place_of_receipt: "横浜工場",
  port_of_loading: "Shanghai",
  port_of_discharge: "Los Angeles",
  port_of_delivery: "LA Warehouse",
  carrier: "NYK LINE",
  create_id: admin_user.id,
  update_id: admin_user.id
)

puts "  ✓ Created Favorite Shipments"

# Favorite Goods
FavoriteGood.create!(
  favorite_id: favorite1.id,
  pkg: "10",
  type_of_pkg: "CARTONS",
  n_w: "1000",
  g_w: "1100",
  three_m: "5.0",
  create_id: admin_user.id,
  update_id: admin_user.id
)

FavoriteGood.create!(
  favorite_id: favorite2.id,
  pkg: "50",
  type_of_pkg: "PALLETS",
  n_w: "5000",
  g_w: "5500",
  three_m: "25.0",
  create_id: admin_user.id,
  update_id: admin_user.id
)

puts "  ✓ Created Favorite Goods"

# Favorite Docs
FavoriteDoc.create!(
  favorite_id: favorite1.id,
  invoice: true,
  packing_list: true,
  msds: true,
  coo: true,
  hbl_awb: true,
  mbl: true,
  create_id: admin_user.id,
  update_id: admin_user.id
)

FavoriteDoc.create!(
  favorite_id: favorite2.id,
  invoice: true,
  packing_list: true,
  coo: true,
  s_i: true,
  hbl_awb: true,
  export_permit: true,
  create_id: admin_user.id,
  update_id: admin_user.id
)

puts "  ✓ Created Favorite Docs"

# Favorite Finbalances
ocean_freight = FinbalanceItem.find_by(item_name: "海上運賃")
thc = FinbalanceItem.find_by(item_name: "THC")
customs_fee = FinbalanceItem.find_by(item_name: "輸入通関費用")

fav_finbalance1 = FavoriteFinbalance.create!(
  favorite_id: favorite1.id,
  balance: 50000,
  income: 300000,
  cost: 250000,
  create_id: admin_user.id,
  update_id: admin_user.id
)

if ocean_freight && thc && customs_fee
  FavoriteFinbalanceAssembly.create!(
    favorite_finbalance_id: fav_finbalance1.id,
    finbalance_item_id: ocean_freight.id,
    cost_amount: 150000,
    income_amount: 180000,
    balance_amount: 30000,
    create_id: admin_user.id,
    update_id: admin_user.id
  )

  FavoriteFinbalanceAssembly.create!(
    favorite_finbalance_id: fav_finbalance1.id,
    finbalance_item_id: thc.id,
    cost_amount: 50000,
    income_amount: 60000,
    balance_amount: 10000,
    create_id: admin_user.id,
    update_id: admin_user.id
  )
end

puts "  ✓ Created Favorite Finbalances"

# ==============================================
# 8. Quotations（見積もり）
# ==============================================
puts "\n📋 Creating Quotations..."

quotation1 = Quotation.create!(
  forwarder_id: forwarder.id,
  client_id: shipper_companies.first.id,
  user_id: admin_user.id,
  place_of_receipt: "Shanghai Factory",
  port_of_loading: "Shanghai",
  port_of_discharge: "Yokohama",
  port_of_delivery: "横浜CY",
  carrier: "ONE",
  issue_at: Time.current,
  valid_at: "30 days",
  shipment: 0,
  mode: 0,
  term: 1,
  cargo: "Electronic Components",
  total_amount: 280000,
  tax_percent: 10,
  remark: "標準的な輸入見積もり",
  create_id: admin_user.id,
  update_id: admin_user.id
)

puts "  ✓ Created #{Quotation.count} Quotations"

# Quotation Companies
QuotationCompany.create!(
  quotation_id: quotation1.id,
  company_id: custom_companies.first.id,
  create_id: admin_user.id,
  update_id: admin_user.id
)

puts "  ✓ Created Quotation Companies"

# Quotation Items
if ocean_freight
  QuotationItem.create!(
    quotation_id: quotation1.id,
    finbalance_item_id: ocean_freight.id,
    item_type: 0,
    tax_flag: false,
    unit: 1,
    section: 0,
    currency: "JPY",
    exchange_rate: 1.0,
    quantity: 1,
    purchase_unit_price: 150000,
    purchase_amount: 150000,
    sales_unit_price: 180000,
    sales_amount: 180000,
    gross_profit: 30000,
    gross_profit_rate: 16.67,
    create_id: admin_user.id,
    update_id: admin_user.id
  )
end

puts "  ✓ Created Quotation Items"

# ==============================================
# 9. Events（案件）
# ==============================================
puts "\n📊 Creating Events..."

event1 = Event.create!(
  forwarder_id: forwarder.id,
  user_id: admin_user.id,
  id_string: "TKY-2025-001",
  year: "2025",
  mbl: "ONESHA250001",
  hbl: "TKY250001",
  soa: 30.days.from_now,
  charge: true,
  description: "電子機器輸入案件（グローバル商事様）",
  remark: "定期便",
  accounting_month: Time.current.beginning_of_month,
  create_id: admin_user.id,
  update_id: admin_user.id
)

event2 = Event.create!(
  forwarder_id: forwarder.id,
  user_id: admin_user.id,
  id_string: "TKY-2025-002",
  year: "2025",
  mbl: "NYKLAX250001",
  hbl: "TKY250002",
  soa: 45.days.from_now,
  charge: true,
  description: "精密機器輸出案件",
  remark: "新規ルート",
  accounting_month: Time.current.beginning_of_month,
  create_id: admin_user.id,
  update_id: admin_user.id
)

puts "  ✓ Created #{Event.count} Events"

# Event Companies
EventCompany.create!(
  event_id: event1.id,
  company_id: shipper_companies.first.id,
  role: 0,
  create_id: admin_user.id,
  update_id: admin_user.id
)

EventCompany.create!(
  event_id: event1.id,
  company_id: custom_companies.first.id,
  role: 2,
  create_id: admin_user.id,
  update_id: admin_user.id
)

puts "  ✓ Created Event Companies"

# Event Shipments
EventShipment.create!(
  event_id: event1.id,
  shipment: 0,
  mode: 0,
  term: 1,
  place_of_receipt: "Shanghai Factory",
  port_of_loading: "Shanghai",
  port_of_discharge: "Yokohama",
  port_of_delivery: "横浜CY",
  vessel: "ONE INNOVATION",
  voyage: "025E",
  booking_no: "ONESHA2500123",
  carrier: "ONE",
  create_id: admin_user.id,
  update_id: admin_user.id
)

puts "  ✓ Created Event Shipments"

# Event Schedules
EventSchedule.create!(
  event_id: event1.id,
  container_pick_up: 5.days.ago,
  vanning_date: 4.days.ago,
  cut_off_date: 2.days.ago,
  pol_etd: 1.day.ago,
  pod_eta: 12.days.from_now,
  delivery_date: 15.days.from_now,
  transportation_status: 1,
  create_id: admin_user.id,
  update_id: admin_user.id
)

puts "  ✓ Created Event Schedules"

# Event Steps
EventStep.create!(
  event_id: event1.id,
  status: 0,
  status_date: 10.days.ago,
  create_id: admin_user.id,
  update_id: admin_user.id
)

EventStep.create!(
  event_id: event1.id,
  status: 1,
  status_date: 5.days.ago,
  create_id: admin_user.id,
  update_id: admin_user.id
)

puts "  ✓ Created Event Steps"

# Event Goods
EventGood.create!(
  event_id: event1.id,
  pkg: "10",
  type_of_pkg: "CARTONS",
  n_w: "1000.00",
  g_w: "1100.00",
  three_m: "5.0",
  create_id: admin_user.id,
  update_id: admin_user.id
)

puts "  ✓ Created Event Goods"

# Event Docs
EventDoc.create!(
  event_id: event1.id,
  invoice: true,
  packing_list: true,
  msds: true,
  coo: true,
  hbl_awb: true,
  mbl: true,
  completed: false,
  create_id: admin_user.id,
  update_id: admin_user.id
)

puts "  ✓ Created Event Docs"

# Containers
Container.create!(
  event_id: event1.id,
  cntr_num: "TGHU1234567",
  cntr_type: "DRY",
  cntr_size: "20",
  cntr_seal: "SH12345",
  cntr_remark: "標準20ftコンテナ",
  create_id: admin_user.id,
  update_id: admin_user.id
)

Container.create!(
  event_id: event2.id,
  cntr_num: "MSCU9876543",
  cntr_type: "DRY",
  cntr_size: "40",
  cntr_seal: "YK67890",
  cntr_remark: "40ftハイキューブ",
  create_id: admin_user.id,
  update_id: admin_user.id
)

puts "  ✓ Created #{Container.count} Containers"

# Finbalances
finbalance1 = Finbalance.create!(
  event_id: event1.id,
  balance: 50000,
  income: 280000,
  cost: 230000,
  create_id: admin_user.id,
  update_id: admin_user.id
)

if ocean_freight && thc && customs_fee
  FinbalanceAssembly.create!(
    finbalance_id: finbalance1.id,
    finbalance_item_id: ocean_freight.id,
    cost_amount: 150000,
    income_amount: 180000,
    balance_amount: 30000,
    create_id: admin_user.id,
    update_id: admin_user.id
  )

  FinbalanceAssembly.create!(
    finbalance_id: finbalance1.id,
    finbalance_item_id: thc.id,
    cost_amount: 50000,
    income_amount: 60000,
    balance_amount: 10000,
    create_id: admin_user.id,
    update_id: admin_user.id
  )
end

puts "  ✓ Created Finbalances & Assemblies"

# ==============================================
# 10. Chats & Messages
# ==============================================
puts "\n💬 Creating Chats & Messages..."

chat1 = Chat.find_or_create_by!(
  event_id: event1.id,
  chat_type: 0
) do |chat|
  chat.name = "グローバル商事様案件 - 上海輸入"
  chat.visible = true
  chat.create_id = admin_user.id
  chat.update_id = admin_user.id
end

operator = User.find_by(email: "operator@tokyo-logistics.example.com")

ChatUser.find_or_create_by!(
  chat_id: chat1.id,
  user_id: admin_user.id
) do |cu|
  cu.create_id = admin_user.id
  cu.update_id = admin_user.id
end

if operator
  ChatUser.find_or_create_by!(
    chat_id: chat1.id,
    user_id: operator.id
  ) do |cu|
    cu.create_id = admin_user.id
    cu.update_id = admin_user.id
  end
end

Message.find_or_create_by!(
  chat_id: chat1.id,
  user_id: admin_user.id,
  content: "案件を作成しました。よろしくお願いします。"
) do |msg|
  msg.create_id = admin_user.id
  msg.update_id = admin_user.id
end

if operator
  Message.find_or_create_by!(
    chat_id: chat1.id,
    user_id: operator.id,
    content: "承知しました。ブッキングを進めます。"
  ) do |msg|
    msg.create_id = operator.id
    msg.update_id = operator.id
  end
end

puts "  ✓ Created #{Chat.count} Chats and #{Message.count} Messages"

# ==============================================
# サマリー表示
# ==============================================
puts "\n" + "="*70
puts "✅ Seed completed successfully!"
puts "="*70
puts "\n📊 Summary:"
puts "  【マスターデータ】"
puts "    - Business Categories: #{BusinessCategory.count}"
puts "    - Companies: #{Company.count}"
puts "      - Forwarders: #{Company.where(is_forwarder: true).count}"
puts "      - Others: #{Company.where(is_forwarder: false).count}"
puts "    - Company Business Categories: #{CompanyBusinessCategory.count}"
puts "    - Users: #{User.count}"
puts "    - Finbalance Items: #{FinbalanceItem.count}"
puts ""
puts "  【テンプレート】"
puts "    - Favorites: #{Favorite.count}"
puts "    - Favorite Companies: #{FavoriteCompany.count}"
puts "    - Favorite Shipments: #{FavoriteShipment.count}"
puts "    - Favorite Goods: #{FavoriteGood.count}"
puts "    - Favorite Docs: #{FavoriteDoc.count}"
puts "    - Favorite Finbalances: #{FavoriteFinbalance.count}"
puts ""
puts "  【見積もり】"
puts "    - Quotations: #{Quotation.count}"
puts "    - Quotation Items: #{QuotationItem.count}"
puts ""
puts "  【案件データ】"
puts "    - Events: #{Event.count}"
puts "    - Event Companies: #{EventCompany.count}"
puts "    - Containers: #{Container.count}"
puts "    - Finbalances: #{Finbalance.count}"
puts ""
puts "  【コミュニケーション】"
puts "    - Chats: #{Chat.count}"
puts "    - Messages: #{Message.count}"
puts ""
puts "🔑 Login Credentials:"
puts "  Admin: admin@tokyo-logistics.example.com / password123"
puts "  Operator: operator@tokyo-logistics.example.com / password123"
puts "  Sales: sales@tokyo-logistics.example.com / password123"
puts "="*70